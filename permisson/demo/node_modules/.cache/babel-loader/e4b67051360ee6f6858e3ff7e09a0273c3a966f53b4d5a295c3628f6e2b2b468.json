{"ast":null,"code":"import \"core-js/modules/es.array.with.js\";\nimport { reactive, toRefs, onMounted } from 'vue';\nimport { createDirectus, rest, readItems, ref } from '@directus/sdk';\n\n// 数据源\n\nexport default {\n  __name: 'productsinfo',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    let dataSource = reactive({\n      tableDatas: [],\n      // 确保 dataSource.tableDatas 一开始是空数组\n      tableColumns: [{\n        title: '产品id',\n        dataIndex: 'id',\n        key: 'id'\n      }, {\n        title: '产品名称',\n        dataIndex: 'name',\n        key: 'name'\n      }, {\n        title: '价格',\n        dataIndex: 'price',\n        key: 'price'\n      }, {\n        title: '类别',\n        dataIndex: 'sort',\n        key: 'sort'\n      }]\n    });\n\n    // 使用 `toRefs` 解构 `reactive` 数据，方便在模板中直接使用\n    let {\n      tableDatas,\n      tableColumns\n    } = toRefs(dataSource);\n    const client = createDirectus('http://localhost:8055').with(rest());\n\n    // 数据存储和状态管理\n    const pr = ref([]);\n    onMounted(async () => {\n      await fetchItems();\n    });\n\n    // 获取产品数据\n    async function fetchItems() {\n      try {\n        const result = await client.request(readItems('products', {\n          fields: ['*']\n        }));\n        console.log(result);\n        pr.value = result.data;\n      } catch (error) {\n        console.error('Failed to fetch items:', error);\n      }\n    }\n    ;\n    const __returned__ = {\n      get dataSource() {\n        return dataSource;\n      },\n      set dataSource(v) {\n        dataSource = v;\n      },\n      get tableDatas() {\n        return tableDatas;\n      },\n      set tableDatas(v) {\n        tableDatas = v;\n      },\n      get tableColumns() {\n        return tableColumns;\n      },\n      set tableColumns(v) {\n        tableColumns = v;\n      },\n      client,\n      pr,\n      fetchItems,\n      reactive,\n      toRefs,\n      onMounted,\n      get createDirectus() {\n        return createDirectus;\n      },\n      get rest() {\n        return rest;\n      },\n      get readItems() {\n        return readItems;\n      },\n      get ref() {\n        return ref;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["reactive","toRefs","onMounted","createDirectus","rest","readItems","ref","dataSource","tableDatas","tableColumns","title","dataIndex","key","client","with","pr","fetchItems","result","request","fields","console","log","value","data","error"],"sources":["E:/permisson/demo/src/views/products/productsinfo.vue"],"sourcesContent":["<template>\r\n    <a-table :dataSource=\"tableDatas\" :columns=\"tableColumns\" />\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, toRefs, onMounted } from 'vue';\r\nimport { createDirectus, rest, readItems, ref } from '@directus/sdk';\r\n\r\n// 数据源\r\nlet dataSource = reactive({\r\n    tableDatas: [],  // 确保 dataSource.tableDatas 一开始是空数组\r\n    tableColumns: [\r\n        {\r\n            title: '产品id',\r\n            dataIndex: 'id',\r\n            key: 'id',\r\n        },\r\n        {\r\n            title: '产品名称',\r\n            dataIndex: 'name',\r\n            key: 'name',\r\n        },\r\n        {\r\n            title: '价格',\r\n            dataIndex: 'price',\r\n            key: 'price',\r\n        },\r\n        {\r\n            title: '类别',\r\n            dataIndex: 'sort',\r\n            key: 'sort',\r\n        }\r\n    ]\r\n});\r\n\r\n// 使用 `toRefs` 解构 `reactive` 数据，方便在模板中直接使用\r\nlet { tableDatas, tableColumns } = toRefs(dataSource);\r\nconst client = createDirectus('http://localhost:8055').with(rest());\r\n\r\n// 数据存储和状态管理\r\nconst pr = ref([]);\r\nonMounted(async () => {\r\n  await fetchItems();\r\n});\r\n\r\n// 获取产品数据\r\nasync function fetchItems() {\r\n  try {\r\n    const result = await client.request(readItems('products', {\r\n      fields: ['*'],\r\n    }));\r\n    console.log(result);\r\n    pr.value = result.data;\r\n  } catch (error) {\r\n    console.error('Failed to fetch items:', error);\r\n  }\r\n};\r\n</script>\r\n"],"mappings":";AAKA,SAASA,QAAQ,EAAEC,MAAM,EAAEC,SAAS,QAAQ,KAAK;AACjD,SAASC,cAAc,EAAEC,IAAI,EAAEC,SAAS,EAAEC,GAAG,QAAQ,eAAe;;AAEpE;;;;;;;;IACA,IAAIC,UAAU,GAAGP,QAAQ,CAAC;MACtBQ,UAAU,EAAE,EAAE;MAAG;MACjBC,YAAY,EAAE,CACV;QACIC,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,IAAI;QACfC,GAAG,EAAE;MACT,CAAC,EACD;QACIF,KAAK,EAAE,MAAM;QACbC,SAAS,EAAE,MAAM;QACjBC,GAAG,EAAE;MACT,CAAC,EACD;QACIF,KAAK,EAAE,IAAI;QACXC,SAAS,EAAE,OAAO;QAClBC,GAAG,EAAE;MACT,CAAC,EACD;QACIF,KAAK,EAAE,IAAI;QACXC,SAAS,EAAE,MAAM;QACjBC,GAAG,EAAE;MACT,CAAC;IAET,CAAC,CAAC;;IAEF;IACA,IAAI;MAAEJ,UAAU;MAAEC;IAAa,CAAC,GAAGR,MAAM,CAACM,UAAU,CAAC;IACrD,MAAMM,MAAM,GAAGV,cAAc,CAAC,uBAAuB,CAAC,CAACW,IAAI,CAACV,IAAI,CAAC,CAAC,CAAC;;IAEnE;IACA,MAAMW,EAAE,GAAGT,GAAG,CAAC,EAAE,CAAC;IAClBJ,SAAS,CAAC,YAAY;MACpB,MAAMc,UAAU,CAAC,CAAC;IACpB,CAAC,CAAC;;IAEF;IACA,eAAeA,UAAUA,CAAA,EAAG;MAC1B,IAAI;QACF,MAAMC,MAAM,GAAG,MAAMJ,MAAM,CAACK,OAAO,CAACb,SAAS,CAAC,UAAU,EAAE;UACxDc,MAAM,EAAE,CAAC,GAAG;QACd,CAAC,CAAC,CAAC;QACHC,OAAO,CAACC,GAAG,CAACJ,MAAM,CAAC;QACnBF,EAAE,CAACO,KAAK,GAAGL,MAAM,CAACM,IAAI;MACxB,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAChD;IACF;IAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}